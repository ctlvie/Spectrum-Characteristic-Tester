# 频谱特性测试仪 作品报告

## 一、设计内容中文摘要

频谱特性测试仪用于测量并显示被测网络的频率特性，本设计由一个正交扫频信号源产生两路正交的正弦信号，正弦信号的频率为1kHz～1MHz，且步进频率可调。其中一路正弦信号作为待测网络的激励，待测网络的输出分别与原先的两路正交信号相乘，经过低通滤波器后即可得到直流分量，再经过ADS1115采样并由MSP430F5529计算待测网络的幅值和相频特性曲线。待测网络为截止频率分别为10kHz和100kHz的二阶有源高通和低通滤波器串联而成。

## 二、设计方案工作原理

### 1.预期目标

设计制作频谱特性测试仪，分别利用扫频法和点频法测量并
显示被测网络的幅频特性曲线、截止频率、相移等参数

### 2. 系统结构工作原理

::信号调理和交互系统结构图::
系统的组成框图如图所示，主控板负责控制AD9854模块实现扫频和点频，同时控制矩阵键盘和LCD12864模块分别实现点频时频率数字的输入和系统界面、曲线图的绘制等。而采样调理的信号经过ADS1115模块进行ADC采样后送入MSP430F5529进行信号处理和运算。
::测量系统结构图::
如图所示，由一个正交扫频信号源产生两路正交的正弦信号，正弦信号的频率为1kHz～1MHz。其中一路正弦信号作为待测网络的激励，待测网络的输出分别与原先的两路正交信号相乘，经过低通滤波器后即可得到直流分量，再经过ADS1115采样并由MSP430F5529计算待测网络的幅值和相频特性曲线。

### 3. 技术方案分析比较

系统总体方案：

	1. 正交扫频信号源的方案选择：
	方案一：使用FPGA实现，由FPGA配合两路DAC，利用RAM中的查找表输出两路正交的正弦信号
	方案二：由主控芯片MSP430F5529驱动AD9854型DDS模块实现两路正弦波的输出
	方案一中需要FPGA实现，成本较高、且对ADC模块的转换速率要求很高，而方案二更加经济实用，因此选择方案二
	2. 乘法器方案选择
	方案一：使用集成乘法器芯片，如AD835
	方案二：由ADC分别对三路信号进行采样，在单片机或FPGA内部运算后再经过DAC转换输出
	方案一成本低廉、结构简单；方案二复杂、对单片机的处理速度有一定要求，占用资源高，因此选用方案一
	3. 采样前级滤波器方案
	方案一：采用RC滤波器构成一阶低通滤波器
	方案二：采用二阶有源滤波器
	方案一结构简单，但部分指标无法满足要求，方案二能有更好的滤波性能，因此采用方案二
	4. ADC方案选择
	方案一：使用MSP430F5529内置ADC
	方案二：使用外置集成ADC芯片，如ADS1115
	方案一虽然控制简单，但精度和速度较低，内置ADC为12位，而选用方案二可以使用采样率更高、位数更大的ADC模块以提高整体系统的精确度，因此选用方案二

### 4. 功能指标实现方法

	1. 被测网络的相关指标实现
	由于被测网络均为运放构成的有源滤波器，具有输入阻抗无穷大，输出阻抗无穷小的特点，因此在被测网络的输入端串接50欧姆电阻到地、输出端串接50欧姆电阻到后级即可实现输入输出阻抗的要求。而两个滤波器的截止频率均可利用公式分别计算出合适的阻值和容值，实现截止频率的指标。::二阶有源滤波器计算公式::
	2. 扫频信号发生器相关指标的实现
	由于题目要求的输出振幅为1V，而AD9854在所给的频率范围内，输出振幅约为500mV左右，因此在后级加入由运放构成的同相比例放大电路，将AD9854输出的信号放大为原先的二倍，即可满足技术指标
	而扫频范围是通过MSP430控制写入AD9854的频率控制字，来改变输出正弦波的频率的，因此只要选择合适的频率控制字即可实现1kHz～1MHz的扫频范围和可选的频率步进方式。
	_3.扫频时间的相关指标实现_ 

## 三、核心部件电路设计

### 1. 被测网络电路

::被测网络电路原理图::
被测网络电路如图所示，采用OP07通用运放构成有源二阶滤波器。将10kHz高通滤波器和100kHz低通滤波器串联，并匹配相应的输入输出电阻，即可得到题目所需的被测网络。

### 2. 正交扫频信号源电路

::正交扫频信号源原理图::
正交扫频信号源采用如下图所示的已有的AD9854DDS模块，配合一定的放大电路构成，放大电路需要将两路信号分别放大两倍，因此采用OP07通用运放配合合适的电阻组成，由::同相比例放大电路公式::，取电阻分别为...

### 3. 乘法电路和ADC前级调理电路

::乘法器和调理模块原理图::
根据数据手册，AD835乘法器的输出为::AD835乘法器公式::，而U一般为定值，约为1.05V，因此将X2，Y2，SUM接地，即可得到输出为::输出公式::
再经过二阶有源滤波器滤除高频分量，仅仅留下直流分量，并由运放放大、抬升电平，使之匹配ADC的采样范围，再送入ADC进行采样

### 4. 核心部件电路仿真

	1. ::被测网络仿真图::
	2. ::乘法器电路仿真图::

## 四、系统软件设计分析

### 1. 软件部分工作流程

::软件流程图::
如图所示，系统的交互部分由按键和LCD屏幕两部分组成，LCD屏幕负责数据显示、曲线绘制、菜单选择等，按键又可分为MSP430F5529最小系统板上的按键S1、S2、以及矩阵键盘两部分，矩阵键盘负责输入数字、S1、S2负责选择、切换、退出各菜单功能。

### 2. 主要模块程序设计

## 五、竞赛工作环境条件

### 1. 软件环境

软件环境主要包括MSP430系列单片机所需的开发平台：CCS，Multisim、OrCAD PSpice等电路仿真软件以及AD18等PCB制板软件

### 2. 仪器设备硬件平台

Tektronix 2012B 混合信号示波器
Tektronix AFG3011C 任意函数信号发生器
扫频仪
稳压电源
万用表
口袋实验室平台

### 3. 前期设计使用模块

AD9854型DDS模块、LCD12864点阵液晶模块、4*4矩阵键盘模块

## 六、元器件清单及价格表

## 七、设计总结

通过测试可以发现，本设计可以基本满足题目所需性能指标，实现“频谱特性测试仪”的功能。


